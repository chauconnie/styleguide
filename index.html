<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Writing Style Guide Assistant</title>
  <style>
    body {
      margin: 0;
      font-family: 'Inter', sans-serif;
      background: #f9fafb;
      display: flex;
      flex-direction: column;
      height: 100vh;
    }

    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 1rem 2rem;
      background: white;
      border-bottom: 1px solid #e5e7eb;
    }

    header .logo {
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    header h1 {
      font-size: 1rem;
      font-weight: 600;
      color: #111827;
      margin: 0;
    }

    .view-guide-btn {
      background: white;
      border: 1px solid #d1d5db;
      padding: 0.5rem 1rem;
      border-radius: 0.5rem;
      font-size: 0.875rem;
      color: #374151;
      cursor: pointer;
      transition: background 0.2s;
    }

    .view-guide-btn:hover {
      background: #f3f4f6;
    }

    main {
      flex: 1;
      overflow-y: auto;
      padding: 2rem;
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }

    .message {
      max-width: 70%;
      padding: 1rem;
      border-radius: 0.75rem;
      font-size: 0.95rem;
      line-height: 1.4;
    }

    .message.bot {
      align-self: flex-start;
      background: #f3f4f6;
      color: #111827;
    }

    .message.user {
      align-self: flex-end;
      background: #3b82f6;
      color: white;
      cursor: pointer;
    }

    footer {
      display: flex;
      gap: 0.5rem;
      padding: 1rem;
      background: white;
      border-top: 1px solid #e5e7eb;
    }

    footer input {
      flex: 1;
      padding: 0.75rem 1rem;
      border-radius: 0.5rem;
      border: 1px solid #d1d5db;
      font-size: 1rem;
    }

    footer button {
      background: #3b82f6;
      color: white;
      border: none;
      padding: 0 1.25rem;
      border-radius: 0.5rem;
      cursor: pointer;
      font-size: 1.25rem;
    }

    footer button:hover {
      background: #2563eb;
    }
  </style>
</head>
<body>
  <header>
    <div class="logo">
      <img src="https://raw.githubusercontent.com/chauconnie/styleguide/main/fh-logo.png" alt="Firsthand" width="200" height="56">
      <h1>WRITING STYLE GUIDE</h1>
    </div>
    <button class="view-guide-btn" onclick="window.open('https://www.notion.so/firsthandlabs/Firsthand-Writing-Style-Guide-19a0efa8732880f69a79d3ea42dee27f', '_blank')">
      View Style Guide
    </button>
  </header>

  <main id="chat">
    <div class="message bot">
      Welcome to the Firsthand Writing Style Guide Assistant! 
      I can help you with questions about our writing standards, voice and tone, grammar guidelines, and more. 
      Type a question, or type <b>"show me FAQ"</b> to see all questions you can click.
    </div>
  </main>

  <footer>
    <input id="userInput" type="text" placeholder="Ask me about our writing style guide..." />
    <button onclick="sendMessage()">&#10148;</button>
  </footer>

  <script>
    const chat = document.getElementById('chat');
    const input = document.getElementById('userInput');

    const faq = [
      "How should titles and headers be capitalized?",
      "How should tooltips and placeholder text be capitalized?",
      "How should button text be capitalized?",
      "What case should field labels use?",
      "How should capitalization be handled in lists and tables?",
      "Are contractions allowed in writing?",
      "How should numbers be written?",
      "When should punctuation be used in tooltips or help text?",
      "Should we use the Oxford comma?",
      "Should optional plurals be shown with (s)?",
      "How should formatting like bold and italics be used?",
      "What tone should we use?",
      "How should users be addressed?",
      "How should button labels be formatted?",
      "How should we write error messages?",
      "How should we write confirmation or success messages?",
      "Whatâ€™s the format for help or instructional text?",
      "What is the format for placeholder text?",
      "How should tooltip content be written?",
      "How should link text be written?",
      "How are proper nouns handled?",
      "How are identifiers displayed?",
      "What format is used for dates?",
      "How should titles be formatted?"
    ];

    function appendMessage(text, sender) {
      const msg = document.createElement('div');
      msg.className = 'message ' + sender;
      msg.textContent = text;
      chat.appendChild(msg);
      chat.scrollTop = chat.scrollHeight;
    }

    function appendFAQ() {
      faq.forEach(q => {
        const msg = document.createElement('div');
        msg.className = 'message user';
        msg.textContent = q;
        msg.onclick = () => sendQuery(q);
        chat.appendChild(msg);
      });
      chat.scrollTop = chat.scrollHeight;
    }

    async function sendQuery(text) {
      appendMessage(text, 'user');
      try {
        const res = await fetch('https://n8n-webhook.dev.firsthand.ai/webhook/search-guides', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ query: text }) // always sends plain string
        });
        const data = await res.json();
        appendMessage(data.answer || 'No answer found.', 'bot');
      } catch (err) {
        appendMessage('Error reaching the server.', 'bot');
      }
    }

    async function sendMessage() {
      const text = input.value.trim();
      if (!text) return;

      input.value = '';
      if (text.toLowerCase().includes('faq')) {
        appendFAQ();
      } else {
        sendQuery(text);
      }
    }

    input.addEventListener('keypress', function (e) {
      if (e.key === 'Enter') sendMessage();
    });
  </script>
</body>
</html>
